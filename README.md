# YouTubeライブチャット集計 & ポイント計算システム

## 概要

本システムは、YouTubeのライブチャットをリアルタイムで取得し、スーパーチャット、スーパーステッカー、新規メンバー加入、メンバーシップアップグレード、メンバーシップギフト数、高評価、設定したキーワードの出現回数を集計し、ポイント化するツールです。

配信者向けのツールとして設計されており、視聴者の応援を可視化することで、リスナーとの一体感を高め、より盛り上がる配信を実現できます。

## 主な機能

### ✅ APIデータの取得

- YouTube Data API v3を使用し、指定した動画のライブチャットを一定間隔で取得
  - ライブチャットIDを取得 (初回のみ) 5クォーター
  - 動画の基本情報と統計情報 (初回のみ) 3クォーター
  - 動画の統計情報のみ 2クォーター
  - チャットメッセージ 1クォーター

### ✅ 集計項目

- 高評価数
- スーパーチャット金額（為替レートに基づき日本円換算）
- スーパーステッカー金額（為替レートに基づき日本円換算）
- 新規メンバーシップの加入、メンバーシップのアップグレード、メンバーシップのギフト数
- 設定したキーワードの出現回数（最大10個、同一コメント内で同じキーワードが複数回出現した場合は全てカウント、同一ユーザーによる同じワードは設定した上限までカウント）
  - 同じキーワードが複数設定されている場合、より後の設定（キーワード番号が大きいもの）が優先されます

### ✅ ポイント計算

- 各集計項目に設定した重み付け係数でポイント化
- 合計ポイントを表示

### ✅ UI機能

- 動画IDを指定してのリアルタイムデータ取得
- 為替レートの初期化と設定
- 集計結果とポイントの表示
- ライブチャットメッセージとハイライト
  - スーパーチャット → **赤**
  - メンバー加入・アップグレード・メンバーギフト → **緑**
  - スーパーステッカー → **オレンジ**
  - 設定したキーワード → **青**
- 動画情報
- 通知機能
  - 各種操作の完了とエラーを通知

## システムの動作フロー

1. APIキーと動画IDを入力し、「開始」ボタンを押下
2. YouTube APIからライブチャットのIDを取得
3. YouTube APIから動画情報を取得（タイトル、チャンネル名、高評価数など）
4. ライブチャットを一定間隔で取得し、リアルタイムの集計処理
5. 「停止」ボタン押下、またはライブ配信の終了にて処理終了

## 技術構成

- **言語:** JavaScript (Vanilla JS)
- **API:** YouTube Data API v3
- **ストレージ:** localStorage（為替レートと設定情報の保存）
- **UI:** HTML + CSS

## 使い方

### 1. 必要な情報を入力

- YouTube APIキーを取得し、APIキー欄に入力
- 解析したい動画のIDを入力

### 2. 設定を調整

- 高評価・スーパーチャット・スーパーステッカー・メンバーシップの重み付け係数を設定
- 個別に指定できるキーワード（最大10個）と重み付け係数を設定
- キーワードの重複カウント設定（同一ユーザーからの重複上限など）
- ポーリング間隔を設定
- 為替レートを設定（必要に応じて）

### 3. ライブチャットの解析を開始

- 「開始」ボタンを押すとデータ取得開始

### 4. 解析結果の確認

- 集計結果を算出して表示
- 集計値×重み付け係数でポイントを計算して表示
- ポイントの総合計を表示

### 5. 停止 & データリセット

- 「停止」ボタンを押すと、処理が終了
- 入力欄が再び編集可能になり、再度「開始」ボタンを押すとその時点から集計（過去に遡って集計はしない）

## 設定ファイル

### `exchangeRates.json`

為替レートを管理するJSONファイル。
各通貨コードと1円あたりのレートの初期値を設定できます。
実際の円換算処理では、ローカルストレージに保存された為替レートを優先します。

例:

```json
{
    "USD": 0.0066,
    "JPY": 1,
    "EUR": 0.0063
}
```

## よくあるエラーと対処法

- **無効なAPIキー**
  - 入力内容を再確認してください
- **ライブ配信が存在しない**
  - 入力した動画IDがライブ配信であることを確認してください
  - 公開配信であることを確認してください（メンバー限定配信は使用できません）
  - ライブが終了していないことを確認してください

## ライセンス

このプロジェクトはMITライセンスのもとで提供されます。
