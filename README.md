# YouTubeライブチャット集計 & ポイント計算システム

## 概要

本システムは、YouTubeのライブチャットをリアルタイムで取得し、スーパーチャット、新規メンバー加入、メンバーシップアップグレード、メンバーギフト、高評価、特定ワードの出現頻度を集計し、ポイント化するツールです。為替レートの設定機能を備え、スーパーチャットの金額を日本円に換算して統計を行います。

## 主な機能

### ✅ ライブチャットの取得

- YouTube Data API v3を使用し、指定した動画のライブチャットを一定間隔で取得
- チャットメッセージの表示とハイライト
- ユーザーごとの発言履歴を管理し、特定ワードのカウント（同一ユーザーによる同じワードの発言は1回のみカウント）

### ✅ 統計情報の集計

- スーパーチャット金額の合計（為替レートに基づき日本円換算）
- スーパーステッカー金額の合計（為替レートに基づき日本円換算）
- 新規メンバー加入、メンバーシップアップグレード、ギフトのカウント
- 高評価数の取得・更新
- 特定ワードの出現回数カウント（同一ユーザーによる同じワードは1回のみカウント）

### ✅ ポイント計算

- 各要素に対して重みを設定し、ポイント化
- 特定ワードごとに重みを設定し、累積ポイントを計算
- ポイントのリアルタイム更新

### ✅ UI機能

- APIキー & 動画IDの入力欄
- 為替レートの設定機能
- 集計結果のリアルタイム表示
- 合計ポイントの表示
- ライブチャットメッセージの色分け
  - スーパーチャット → **赤**
  - メンバー加入 → **緑**
  - スーパーステッカー → **オレンジ**
  - 特定ワードを含む発言 → **青**
- 通知システム
  - APIエラーや処理の完了を通知

## システムの動作フロー

1. APIキー & 動画IDを入力し、「開始」ボタンを押す
2. YouTube APIからライブチャットのIDを取得
3. YouTube APIから動画情報を取得（タイトル、チャンネル名、高評価数など）
4. ライブチャットを一定間隔で取得 & 解析
5. スーパーチャット・スーパーステッカー・特定ワード・新規メンバー・アップグレード・ギフトをカウント
6. 各データをポイントに変換し、画面に表示
7. 「停止」ボタンを押すと、処理を終了 & UIをリセット

## 技術構成

- **言語:** JavaScript (Vanilla JS)
- **API:** YouTube Data API v3
- **ストレージ:** localStorage（為替レート & 設定情報の保存）
- **UI:** HTML + CSS
- **データ管理:**
  - `liveChatData` → ライブチャットのデータ格納
  - `exchangeRates` → 為替レートデータ（JSONファイル & ローカルストレージ）
  - `userWordHistory` → ユーザーごとの発言履歴

## 使い方

### 1. 必要な情報を入力

- YouTube APIキーを取得し、APIキー欄に入力
- 解析したい動画のIDを入力

### 2. 設定を調整

- 高評価・スーパーチャット・スーパーステッカー・メンバーシップの重みを設定
- 個別に指定できるキーワード(最大3つ)と重みを設定
- 為替レートを設定（必要に応じて）

### 3. ライブチャットの解析を開始

- 「開始」ボタンを押すとデータ取得開始
- 一定間隔で動画の高評価数とメッセージを解析

### 4. 解析結果の確認

- 集計結果を算出して表示
- 集計値×係数(重み)にてポイントを計算して表示
- ポイントの総合計を表示

### 5. 停止 & データリセット

- 「停止」ボタンを押すと、処理が終了
- 入力欄が再び編集可能になり、再度「開始」ボタンを押すとその時点から集計
- 過去に遡って集計はしない

## 設定ファイル

### `exchangeRates.json`

為替レートの初期値を管理するJSONファイル。
各通貨コードと1円あたりのレートを設定しておき、大きく変動する場合はメンテナンスが望ましい
実際の円換算処理ではローカルストレージに保存した為替レートが優先

例:

```json
{
    "USD": 0.0066,
    "JPY": 1,
    "EUR": 0.0063
}
```

## よくあるエラーと対処法

- **無効なAPIキー**
  - 入力内容を再確認する
- **ライブ配信が存在しない**
  - 入力した動画IDがライブ配信であることを確認

## ライセンス

このプロジェクトはMITライセンスのもとで提供されます。